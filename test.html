<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>ç«æŸ´äººå°æ±ºï¼ˆå®Œæˆç‰ˆï¼‰</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<style>
body{margin:0;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background:#111;color:#fff;font-family:system-ui;touch-action:none}
canvas{background:#f5f5f5;border-radius:12px;display:none}
.menu,.end{display:flex;flex-direction:column;gap:12px;align-items:center}
button{font-size:14px;padding:10px 14px;border-radius:10px;border:none}
input,select{font-size:14px;padding:6px;border-radius:6px;border:none}

/* æ‰‹æ©Ÿæ©«å‘å„ªåŒ– */
@media (orientation: landscape){
  body{flex-direction:row;justify-content:space-around}
  canvas{width:60vw;height:auto}
  #mobileControls{flex-direction:row;width:35vw}
}
</style>
</head>
<body>

<!-- è§’è‰²è¨­å®š -->
<div id="menu" class="menu">
  <h2>è§’è‰²è¨­å®š</h2>
  <div>ç©å®¶1 åå­— <input id="name1" value="ç©å®¶1"> é¡è‰²
    <select id="color1"><option value="#000">é»‘</option><option value="red">ç´…</option><option value="blue">è—</option><option value="green">ç¶ </option></select>
  </div>
  <div>ç©å®¶2 åå­— <input id="name2" value="ç©å®¶2"> é¡è‰²
    <select id="color2"><option value="#000">é»‘</option><option value="red">ç´…</option><option value="blue">è—</option><option value="green">ç¶ </option></select>
  </div>
  <button onclick="startGame()">é–‹å§‹éŠæˆ²</button>
</div>

<!-- éŠæˆ²ç•«é¢ -->
<canvas id="game" width="360" height="400"></canvas>

<!-- æ“ä½œæç¤ºï¼ˆåœ–ç¤ºåŒ–ï¼‹é›™æ‰‹ï¼‰ -->
<div id="hints" style="font-size:12px;text-align:center;margin-top:6px;display:flex;gap:10px;flex-wrap:wrap;justify-content:center">
  <div style="background:#222;padding:8px 12px;border-radius:12px;display:flex;align-items:center;gap:6px">
    <span style="font-size:20px">âœ‹</span>
    <span>ğŸ’» P1</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">A</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">D</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">W</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">F</span>
  </div>

  <div style="background:#222;padding:8px 12px;border-radius:12px;display:flex;align-items:center;gap:6px">
    <span style="font-size:20px">ğŸ¤š</span>
    <span>ğŸ’» P2</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">â†</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">â†’</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">â†‘</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">/</span>
  </div>

  <div style="background:#222;padding:8px 12px;border-radius:12px;display:flex;align-items:center;gap:6px">
    <span style="font-size:20px">âœ‹</span>
    <span>ğŸ“± ç©å®¶1</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">â—€</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">â–¶</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">è·³</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">ğŸ‘Š</span>
  </div>

  <div style="background:#222;padding:8px 12px;border-radius:12px;display:flex;align-items:center;gap:6px">
    <span style="font-size:20px">ğŸ¤š</span>
    <span>ğŸ“± ç©å®¶2</span>
    <span style="border:1px solid #555;border-radius:6px;padding:2px 6px">ğŸ‘Š</span>
  </div>
</div>
  <div style="background:#222;padding:6px 10px;border-radius:8px">ğŸ’» P2ï¼š<span style="border:1px solid #555;border-radius:4px;padding:2px 4px">â†</span><span style="border:1px solid #555;border-radius:4px;padding:2px 4px">â†’</span> ç§»å‹•ï½œ<span style="border:1px solid #555;border-radius:4px;padding:2px 4px">â†‘</span> è·³ï½œ<span style="border:1px solid #555;border-radius:4px;padding:2px 4px">/</span> ğŸ‘Š</div>
  <div style="background:#222;padding:6px 10px;border-radius:8px">ğŸ“± ç©å®¶1ï¼šâ—€ â–¶ è·³ ğŸ‘Š</div>
  <div style="background:#222;padding:6px 10px;border-radius:8px">ğŸ“± ç©å®¶2ï¼šğŸ‘Š</div>
</div>
  <div>ğŸ“± æ‰‹æ©Ÿï¼šå·¦å´ï¼ç©å®¶1 æ“ä½œï½œå³å´ï¼ç©å®¶2 å‡ºæ‹³</div>
</div>

<!-- æ‰‹æ©Ÿæ“ä½œæŒ‰éˆ•ï¼ˆé›™äººå®Œæ•´ï¼‰ -->
<div id="mobileControls" style="display:none;margin-top:8px;width:360px;display:flex;justify-content:space-between">
  <!-- ç©å®¶1 å·¦æ‰‹ -->
  <div style="display:flex;flex-direction:column;gap:6px">
    <div>
      <button ontouchstart="m1L=true" ontouchend="m1L=false">â—€</button>
      <button ontouchstart="m1R=true" ontouchend="m1R=false">â–¶</button>
    </div>
    <button ontouchstart="m1J=true" ontouchend="m1J=false">è·³</button>
    <button ontouchstart="m1P=true" ontouchend="m1P=false">ğŸ‘Š</button>
  </div>

  <!-- ç©å®¶2 å³æ‰‹ -->
  <div style="display:flex;flex-direction:column;gap:6px">
    <div>
      <button ontouchstart="m2L=true" ontouchend="m2L=false">â—€</button>
      <button ontouchstart="m2R=true" ontouchend="m2R=false">â–¶</button>
    </div>
    <button ontouchstart="m2J=true" ontouchend="m2J=false">è·³</button>
    <button ontouchstart="m2P=true" ontouchend="m2P=false">ğŸ‘Š</button>
  </div>
</div>

<!-- çµæŸç•«é¢ -->
<div id="end" class="end" style="display:none">
  <h2 id="winner"></h2>
  <button onclick="restart()">é‡æ–°é–‹å§‹</button>
  <button onclick="backToMenu()">å›åˆ°è§’è‰²è¨­å®š</button>
</div>

<script>
const canvas=document.getElementById('game'),ctx=canvas.getContext('2d');
const groundY=300,gravity=0.8;
const key={};window.addEventListener('keydown',e=>key[e.key]=true);window.addEventListener('keyup',e=>key[e.key]=false);
let p1,p2,gameOver=false;
let m1L=false,m1R=false,m1J=false,m1P=false;
let m2L=false,m2R=false,m2J=false,m2P=false;

function createFighter(x,name,color){return{x,y:groundY,vy:0,hp:100,onGround:true,punch:false,name,color}}

function startGame(){
  p1=createFighter(90,name1.value,color1.value);
  p2=createFighter(270,name2.value,color2.value);
  gameOver=false;
  menu.style.display='none';
  mobileControls.style.display='flex';
  end.style.display='none';
  canvas.style.display='block';
  loop();
}

function restart(){
  p1.hp=100;p2.hp=100;
  p1.x=90;p2.x=270;
  gameOver=false;
  end.style.display='none';
  canvas.style.display='block';
  loop();
}

function backToMenu(){
  canvas.style.display='none';
  end.style.display='none';
  menu.style.display='flex';
}

function update(p,e,ctrl){
 if(ctrl.L)p.x-=3;if(ctrl.R)p.x+=3;
 if(ctrl.J&&p.onGround){p.vy=-12;p.onGround=false}
 p.vy+=gravity;p.y+=p.vy;
 if(p.y>=groundY){p.y=groundY;p.vy=0;p.onGround=true}
 if(ctrl.P&&!p.punch){p.punch=true;setTimeout(()=>p.punch=false,200);if(Math.abs(p.x-e.x)<40)e.hp=Math.max(0,e.hp-10)}
 p.x=Math.max(20,Math.min(canvas.width-20,p.x));
}

function draw(p){ctx.strokeStyle=p.color;ctx.lineWidth=4;
 ctx.beginPath();ctx.arc(p.x,p.y-50,10,0,Math.PI*2);ctx.stroke();
 ctx.beginPath();ctx.moveTo(p.x,p.y-40);ctx.lineTo(p.x,p.y-10);ctx.stroke();
 ctx.beginPath();ctx.moveTo(p.x,p.y-10);ctx.lineTo(p.x-10,p.y+15);ctx.moveTo(p.x,p.y-10);ctx.lineTo(p.x+10,p.y+15);ctx.stroke();
 ctx.beginPath();ctx.moveTo(p.x,p.y-30);ctx.lineTo(p.x+(p.punch?25:15),p.y-25);ctx.stroke();
 ctx.fillStyle=p.color;ctx.font='12px system-ui';ctx.textAlign='center';ctx.fillText(p.name,p.x,p.y-70)}

function drawHP(p,x){ctx.fillStyle='#ccc';ctx.fillRect(x,10,100,8);ctx.fillStyle=p.color;ctx.fillRect(x,10,p.hp,8)}

function loop(){
 if(gameOver) return;
 ctx.clearRect(0,0,canvas.width,canvas.height);
 update(p1,p2,{L:key.a||m1L,R:key.d||m1R,J:key.w||m1J,P:key.f||m1P});
 update(p2,p1,{L:key.ArrowLeft||m2L,R:key.ArrowRight||m2R,J:key.ArrowUp||m2J,P:key['/']||m2P});
 draw(p1);draw(p2);drawHP(p1,10);drawHP(p2,canvas.width-110);
 if(p1.hp===0||p2.hp===0){
  gameOver=true;
  canvas.style.display='none';
  winner.innerText=(p1.hp===0?p2.name:p1.name)+' ç²å‹';
  end.style.display='flex';
  return;
 }
 requestAnimationFrame(loop);
}
</script>
</body>
</html>
