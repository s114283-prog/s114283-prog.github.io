<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>ç«æŸ´äººå°æ±º</title>
<link rel="icon" type="image/png" href="images.jpg">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
html,body{margin:0;width:100%;height:100%}
body{
  display:flex;justify-content:center;align-items:center;
  background:#111;color:#fff;font-family:system-ui;
}
#app{width:360px;text-align:center}
canvas{background:#f5f5f5;border-radius:12px;margin:10px 0}
button,select{padding:8px 12px;border-radius:10px;border:none}
.menu,.end{display:flex;flex-direction:column;gap:10px;align-items:center}
.key{
  display:inline-block;border:1px solid #555;
  padding:2px 6px;border-radius:6px;
  background:#222;font-size:11px
}
#mobileControls{display:none;justify-content:space-between}
@media (orientation: landscape){
  #mobileControls{display:flex}
}
</style>
</head>

<body>
<div id="app">

<div id="menu" class="menu">
  <h2>ç«æŸ´äººå°æ±º</h2>

  <label><input type="radio" name="mode" value="cpu" checked> å–®äººï¼ˆé›»è…¦ï¼‰</label>
  <label><input type="radio" name="mode" value="pvp"> é›™äºº</label>

  AI é›£åº¦
  <select id="difficulty">
    <option value="easy">ç°¡å–®</option>
    <option value="normal" selected>æ™®é€š</option>
    <option value="hard">å›°é›£</option>
  </select>

  <div>ç©å®¶1 <input id="n1" value="ç©å®¶1"> <input type="color" id="c1" value="#000000"></div>
  <div>ç©å®¶2 <input id="n2" value="ç©å®¶2"> <input type="color" id="c2" value="#ff0000"></div>

  <button onclick="start()">é–‹å§‹éŠæˆ²</button>
</div>

<canvas id="game" width="360" height="400" style="display:none"></canvas>

<div id="mobileControls">
  <div>
    <button ontouchstart="m1L=1" ontouchend="m1L=0">â—€</button>
    <button ontouchstart="m1R=1" ontouchend="m1R=0">â–¶</button>
    <button ontouchstart="m1P=1" ontouchend="m1P=0">ğŸ‘Š</button>
    <button ontouchstart="m1U=1" ontouchend="m1U=0">ğŸ”¥</button>
  </div>
  <div>
    <button ontouchstart="m2L=1" ontouchend="m2L=0">â—€</button>
    <button ontouchstart="m2R=1" ontouchend="m2R=0">â–¶</button>
    <button ontouchstart="m2P=1" ontouchend="m2P=0">ğŸ‘Š</button>
    <button ontouchstart="m2U=1" ontouchend="m2U=0">ğŸ”¥</button>
  </div>
</div>

<div id="hint" style="font-size:12px;margin-top:6px">
ğŸ’» P1 <span class="key">A</span><span class="key">D</span><span class="key">F</span><span class="key">G</span>
ï½œ P2 <span class="key">â†</span><span class="key">â†’</span><span class="key">/</span><span class="key">.</span><br>
ğŸ“± æ‰‹æ©Ÿï¼šå·¦å³ãƒ»å‡ºæ‹³ãƒ»å¿…æ®º
</div>

<div id="end" class="end" style="display:none">
  <h2 id="win"></h2>
  <button onclick="start()">å†ä¾†ä¸€å ´</button>
</div>

</div>

<script>
const c=game,ctx=c.getContext("2d");
const ground=300,grav=0.8;
let k={},over=false,mode="cpu",aiLevel="normal";
let m1L=0,m1R=0,m1P=0,m1U=0,m2L=0,m2R=0,m2P=0,m2U=0;

window.onkeydown=e=>k[e.key]=1;
window.onkeyup=e=>k[e.key]=0;

function fighter(x,name,color){
  return{x,y:ground,vy:0,hp:100,energy:0,
    name,color,dead:false,rot:0,punchCD:0,ultCD:0}
}
let p1,p2,effects=[];

const AI={
  easy:{speed:2.2,range:50,ult:0.01},
  normal:{speed:3,range:65,ult:0.05},
  hard:{speed:3.6,range:75,ult:0.12}
};

function hit(a,d,dam){
  d.hp=Math.max(0,d.hp-dam);
  a.energy=Math.min(100,a.energy+10);
  effects.push({x:d.x,y:d.y-40,r:6,l:12});
}

function update(p,e,L,R,P,U,s){
  if(p.dead)return;
  if(L)p.x-=s;if(R)p.x+=s;
  p.x=Math.max(20,Math.min(340,p.x));
  p.vy+=grav;p.y+=p.vy;
  if(p.y>=ground){p.y=ground;p.vy=0}

  if(p.punchCD>0)p.punchCD--;
  if(p.ultCD>0)p.ultCD--;

  if(P&&p.punchCD===0){
    p.punchCD=18;
    if(Math.abs(p.x-e.x)<55)hit(p,e,10);
  }
  if(U&&p.energy>=100&&p.ultCD===0){
    p.energy=0;p.ultCD=80;
    if(Math.abs(p.x-e.x)<90)hit(p,e,30);
  }
}

function cpu(cpu,pl){
  const c=AI[aiLevel];
  let d=pl.x-cpu.x,a=Math.abs(d);
  let L=0,R=0,P=0,U=0;
  if(a>c.range){d>0?R=1:L=1}else P=1;
  if(cpu.energy>=100&&Math.random()<c.ult)U=1;
  update(cpu,
